{"version":3,"file":"ChangesView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/changes/ChangesView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2017 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Diff from '../../third_party/diff/diff.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport changesViewStyles from './changesView.css.js';\n\nimport type * as Workspace from '../../models/workspace/workspace.js';\nimport * as WorkspaceDiff from '../../models/workspace_diff/workspace_diff.js';\n\nimport {ChangesSidebar, Events} from './ChangesSidebar.js';\nimport {ChangesTextEditor} from './ChangesTextEditor.js';\n\nconst UIStrings = {\n  /**\n  *@description Screen-reader accessible name for the code editor in the Changes tool showing the user's changes.\n  */\n  changesDiffViewer: 'Changes diff viewer',\n  /**\n  *@description Screen reader/tooltip label for a button in the Changes tool that reverts all changes to the currently open file.\n  */\n  revertAllChangesToCurrentFile: 'Revert all changes to current file',\n  /**\n  *@description Text in Changes View of the Changes tab\n  */\n  noChanges: 'No changes',\n  /**\n  *@description Text in Changes View of the Changes tab\n  */\n  binaryData: 'Binary data',\n  /**\n  * @description Text in the Changes tab that indicates how many lines of code have changed in the\n  * selected file. An insertion refers to an added line of code. The (+) is a visual cue to indicate\n  * lines were added (not translatable).\n  */\n  sInsertions: '{n, plural, =1 {# insertion (+)} other {# insertions (+)}}',\n  /**\n  * @description Text in the Changes tab that indicates how many lines of code have changed in the\n  * selected file. A deletion refers to a removed line of code. The (-) is a visual cue to indicate\n  * lines were removed (not translatable).\n  */\n  sDeletions: '{n, plural, =1 {# deletion (-)} other {# deletions (-)}}',\n  /**\n  *@description Text in Changes View of the Changes tab\n  *@example {2} PH1\n  */\n  SkippingDMatchingLines: '( … Skipping {PH1} matching lines … )',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/changes/ChangesView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nlet changesViewInstance: ChangesView;\n\nexport class ChangesView extends UI.Widget.VBox {\n  private emptyWidget: UI.EmptyWidget.EmptyWidget;\n  private readonly workspaceDiff: WorkspaceDiff.WorkspaceDiff.WorkspaceDiffImpl;\n  readonly changesSidebar: ChangesSidebar;\n  private selectedUISourceCode: Workspace.UISourceCode.UISourceCode|null;\n  private diffRows: Row[];\n  private maxLineDigits: number;\n  private readonly editor: ChangesTextEditor;\n  private readonly toolbar: UI.Toolbar.Toolbar;\n  private readonly diffStats: UI.Toolbar.ToolbarText;\n\n  private constructor() {\n    super(true);\n\n    const splitWidget = new UI.SplitWidget.SplitWidget(true /* vertical */, false /* sidebar on left */);\n    const mainWidget = new UI.Widget.Widget();\n    splitWidget.setMainWidget(mainWidget);\n    splitWidget.show(this.contentElement);\n\n    this.emptyWidget = new UI.EmptyWidget.EmptyWidget('');\n    this.emptyWidget.show(mainWidget.element);\n\n    this.workspaceDiff = WorkspaceDiff.WorkspaceDiff.workspaceDiff();\n    this.changesSidebar = new ChangesSidebar(this.workspaceDiff);\n    this.changesSidebar.addEventListener(Events.SelectedUISourceCodeChanged, this.selectedUISourceCodeChanged, this);\n    splitWidget.setSidebarWidget(this.changesSidebar);\n\n    this.selectedUISourceCode = null;\n\n    this.diffRows = [];\n\n    this.maxLineDigits = 1;\n\n    this.editor = new ChangesTextEditor({\n      bracketMatchingSetting: undefined,\n      devtoolsAccessibleName: i18nString(UIStrings.changesDiffViewer),\n      lineNumbers: true,\n      lineWrapping: false,\n      mimeType: undefined,\n      autoHeight: undefined,\n      padBottom: undefined,\n      maxHighlightLength: Infinity,  // Avoid CodeMirror bailing out of highlighting big diffs.\n      placeholder: undefined,\n      lineWiseCopyCut: undefined,\n      inputStyle: undefined,\n    });\n    this.editor.setReadOnly(true);\n    const editorContainer = mainWidget.element.createChild('div', 'editor-container');\n    UI.ARIAUtils.markAsTabpanel(editorContainer);\n    this.editor.show(editorContainer);\n    this.editor.hideWidget();\n\n    self.onInvokeElement(this.editor.element, this.click.bind(this));\n\n    this.toolbar = new UI.Toolbar.Toolbar('changes-toolbar', mainWidget.element);\n    const revertButton =\n        new UI.Toolbar.ToolbarButton(i18nString(UIStrings.revertAllChangesToCurrentFile), 'largeicon-undo');\n    revertButton.addEventListener(UI.Toolbar.ToolbarButton.Events.Click, this.revert.bind(this));\n    this.toolbar.appendToolbarItem(revertButton);\n    this.diffStats = new UI.Toolbar.ToolbarText('');\n    this.toolbar.appendToolbarItem(this.diffStats);\n    this.toolbar.setEnabled(false);\n\n    this.hideDiff(i18nString(UIStrings.noChanges));\n    this.selectedUISourceCodeChanged();\n  }\n\n  static instance(opts: {forceNew: boolean|null} = {forceNew: null}): ChangesView {\n    const {forceNew} = opts;\n    if (!changesViewInstance || forceNew) {\n      changesViewInstance = new ChangesView();\n    }\n\n    return changesViewInstance;\n  }\n\n  private selectedUISourceCodeChanged(): void {\n    this.revealUISourceCode(this.changesSidebar.selectedUISourceCode());\n  }\n\n  private revert(): void {\n    const uiSourceCode = this.selectedUISourceCode;\n    if (!uiSourceCode) {\n      return;\n    }\n    this.workspaceDiff.revertToOriginal(uiSourceCode);\n  }\n\n  private click(event: Event): void {\n    const selection = this.editor.selection();\n    if (!selection.isEmpty() || !this.selectedUISourceCode) {\n      return;\n    }\n    const row = this.diffRows[selection.startLine];\n    Common.Revealer.reveal(\n        this.selectedUISourceCode.uiLocation(row.currentLineNumber - 1, selection.startColumn), false);\n    event.consume(true);\n  }\n\n  private revealUISourceCode(uiSourceCode: Workspace.UISourceCode.UISourceCode|null): void {\n    if (this.selectedUISourceCode === uiSourceCode) {\n      return;\n    }\n\n    if (this.selectedUISourceCode) {\n      this.workspaceDiff.unsubscribeFromDiffChange(this.selectedUISourceCode, this.refreshDiff, this);\n    }\n    if (uiSourceCode && this.isShowing()) {\n      this.workspaceDiff.subscribeToDiffChange(uiSourceCode, this.refreshDiff, this);\n    }\n\n    this.selectedUISourceCode = uiSourceCode;\n    this.refreshDiff();\n  }\n\n  wasShown(): void {\n    this.refreshDiff();\n    this.registerCSSFiles([changesViewStyles]);\n  }\n\n  private refreshDiff(): void {\n    if (!this.isShowing()) {\n      return;\n    }\n\n    if (!this.selectedUISourceCode) {\n      this.renderDiffRows(null);\n      return;\n    }\n    const uiSourceCode = this.selectedUISourceCode;\n    if (!uiSourceCode.contentType().isTextType()) {\n      this.hideDiff(i18nString(UIStrings.binaryData));\n      return;\n    }\n    this.workspaceDiff.requestDiff(uiSourceCode).then((diff: Diff.Diff.DiffArray|null): void => {\n      if (this.selectedUISourceCode !== uiSourceCode) {\n        return;\n      }\n      this.renderDiffRows(diff);\n    });\n  }\n\n  private hideDiff(message: string): void {\n    this.diffStats.setText('');\n    this.toolbar.setEnabled(false);\n    this.editor.hideWidget();\n    this.emptyWidget.text = message;\n    this.emptyWidget.showWidget();\n  }\n\n  private renderDiffRows(diff: Diff.Diff.DiffArray|null): void {\n    this.diffRows = [];\n\n    if (!diff || (diff.length === 1 && diff[0][0] === Diff.Diff.Operation.Equal)) {\n      this.hideDiff(i18nString(UIStrings.noChanges));\n      return;\n    }\n\n    let insertions = 0;\n    let deletions = 0;\n    let currentLineNumber = 0;\n    let baselineLineNumber = 0;\n    const paddingLines = 3;\n\n    const originalLines: string[] = [];\n    const currentLines: string[] = [];\n\n    for (let i = 0; i < diff.length; ++i) {\n      const token = diff[i];\n      switch (token[0]) {\n        case Diff.Diff.Operation.Equal:\n          this.diffRows.push(...createEqualRows(token[1], i === 0, i === diff.length - 1));\n          originalLines.push(...token[1]);\n          currentLines.push(...token[1]);\n          break;\n        case Diff.Diff.Operation.Insert:\n          for (const line of token[1]) {\n            this.diffRows.push(createRow(line, RowType.Addition));\n          }\n          insertions += token[1].length;\n          currentLines.push(...token[1]);\n          break;\n        case Diff.Diff.Operation.Delete:\n          deletions += token[1].length;\n          originalLines.push(...token[1]);\n          if (diff[i + 1] && diff[i + 1][0] === Diff.Diff.Operation.Insert) {\n            i++;\n            this.diffRows.push(...createModifyRows(token[1].join('\\n'), diff[i][1].join('\\n')));\n            insertions += diff[i][1].length;\n            currentLines.push(...diff[i][1]);\n          } else {\n            for (const line of token[1]) {\n              this.diffRows.push(createRow(line, RowType.Deletion));\n            }\n          }\n          break;\n      }\n    }\n\n    this.maxLineDigits = Math.ceil(Math.log10(Math.max(currentLineNumber, baselineLineNumber)));\n\n    const insertionText = i18nString(UIStrings.sInsertions, {n: insertions});\n    const deletionText = i18nString(UIStrings.sDeletions, {n: deletions});\n\n    this.diffStats.setText(`${insertionText}, ${deletionText}`);\n    this.toolbar.setEnabled(true);\n    this.emptyWidget.hideWidget();\n\n    this.editor.operation((): void => {\n      this.editor.showWidget();\n      this.editor.setHighlightMode({\n        name: 'devtools-diff',\n        diffRows: this.diffRows,\n        mimeType: /** @type {!Workspace.UISourceCode.UISourceCode} */ (\n                      this.selectedUISourceCode as Workspace.UISourceCode.UISourceCode)\n                      .mimeType(),\n        baselineLines: originalLines,\n        currentLines: currentLines,\n      });\n      this.editor.setText(this.diffRows\n                              .map(\n                                  (row: Row): string =>\n                                      row.tokens.map((t: {text: string, className: string}): string => t.text).join(''))\n                              .join('\\n'));\n      this.editor.setLineNumberFormatter(this.lineFormatter.bind(this));\n      this.editor.updateDiffGutter(this.diffRows);\n    });\n\n    function createEqualRows(lines: string[], atStart: boolean, atEnd: boolean): Row[] {\n      const equalRows = [];\n      if (!atStart) {\n        for (let i = 0; i < paddingLines && i < lines.length; i++) {\n          equalRows.push(createRow(lines[i], RowType.Equal));\n        }\n        if (lines.length > paddingLines * 2 + 1 && !atEnd) {\n          equalRows.push(createRow(\n              i18nString(UIStrings.SkippingDMatchingLines, {PH1: (lines.length - paddingLines * 2)}), RowType.Spacer));\n        }\n      }\n      if (!atEnd) {\n        const start = Math.max(lines.length - paddingLines - 1, atStart ? 0 : paddingLines);\n        let skip = lines.length - paddingLines - 1;\n        if (!atStart) {\n          skip -= paddingLines;\n        }\n        if (skip > 0) {\n          baselineLineNumber += skip;\n          currentLineNumber += skip;\n        }\n\n        for (let i = start; i < lines.length; i++) {\n          equalRows.push(createRow(lines[i], RowType.Equal));\n        }\n      }\n      return equalRows;\n    }\n\n    function createModifyRows(before: string, after: string): Row[] {\n      const internalDiff = Diff.Diff.DiffWrapper.charDiff(before, after, true /* cleanup diff */);\n      const deletionRows = [createRow('', RowType.Deletion)];\n      const insertionRows = [createRow('', RowType.Addition)];\n\n      for (const token of internalDiff) {\n        const text = token[1];\n        const type = token[0];\n        const className = type === Diff.Diff.Operation.Equal ? '' : 'inner-diff';\n        const lines = text.split('\\n');\n        for (let i = 0; i < lines.length; i++) {\n          if (i > 0 && type !== Diff.Diff.Operation.Insert) {\n            deletionRows.push(createRow('', RowType.Deletion));\n          }\n          if (i > 0 && type !== Diff.Diff.Operation.Delete) {\n            insertionRows.push(createRow('', RowType.Addition));\n          }\n          if (!lines[i]) {\n            continue;\n          }\n          if (type !== Diff.Diff.Operation.Insert) {\n            deletionRows[deletionRows.length - 1].tokens.push({text: lines[i], className});\n          }\n          if (type !== Diff.Diff.Operation.Delete) {\n            insertionRows[insertionRows.length - 1].tokens.push({text: lines[i], className});\n          }\n        }\n      }\n      return deletionRows.concat(insertionRows);\n    }\n\n    function createRow(text: string, type: RowType): Row {\n      if (type === RowType.Addition) {\n        currentLineNumber++;\n      }\n      if (type === RowType.Deletion) {\n        baselineLineNumber++;\n      }\n      if (type === RowType.Equal) {\n        baselineLineNumber++;\n        currentLineNumber++;\n      }\n\n      return {baselineLineNumber, currentLineNumber, tokens: text ? [{text, className: 'inner-diff'}] : [], type};\n    }\n  }\n\n  private lineFormatter(lineNumber: number): string {\n    const row = this.diffRows[lineNumber - 1];\n    let showBaseNumber = row.type === RowType.Deletion;\n    let showCurrentNumber = row.type === RowType.Addition;\n    if (row.type === RowType.Equal) {\n      showBaseNumber = true;\n      showCurrentNumber = true;\n    }\n    const baseText = showBaseNumber ? String(row.baselineLineNumber) : '';\n    const base = baseText.padStart(this.maxLineDigits, '\\xA0');\n    const currentText = showCurrentNumber ? String(row.currentLineNumber) : '';\n    const current = currentText.padStart(this.maxLineDigits, '\\xA0');\n    return base + '\\xA0' + current;\n  }\n}\n\nexport const enum RowType {\n  Deletion = 'deletion',\n  Addition = 'addition',\n  Equal = 'equal',\n  Spacer = 'spacer',\n}\n\nlet diffUILocationRevealerInstance: DiffUILocationRevealer;\nexport class DiffUILocationRevealer implements Common.Revealer.Revealer {\n  static instance(opts: {forceNew: boolean} = {forceNew: false}): DiffUILocationRevealer {\n    const {forceNew} = opts;\n    if (!diffUILocationRevealerInstance || forceNew) {\n      diffUILocationRevealerInstance = new DiffUILocationRevealer();\n    }\n\n    return diffUILocationRevealerInstance;\n  }\n\n  async reveal(diffUILocation: Object, omitFocus?: boolean|undefined): Promise<void> {\n    if (!(diffUILocation instanceof WorkspaceDiff.WorkspaceDiff.DiffUILocation)) {\n      throw new Error('Internal error: not a diff ui location');\n    }\n    await UI.ViewManager.ViewManager.instance().showView('changes.changes');\n    ChangesView.instance().changesSidebar.selectUISourceCode(diffUILocation.uiSourceCode, omitFocus);\n  }\n}\n\nexport interface Token {\n  text: string;\n  className: string;\n}\nexport interface Row {\n  baselineLineNumber: number;\n  currentLineNumber: number;\n  tokens: Token[];\n  type: RowType;\n}\n"]}