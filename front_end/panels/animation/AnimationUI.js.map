{"version":3,"file":"AnimationUI.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationUI.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as InlineEditor from '../../ui/legacy/components/inline_editor/inline_editor.js';\n\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport type {AnimationImpl, KeyframeStyle} from './AnimationModel.js';\nimport type {AnimationTimeline} from './AnimationTimeline.js';\nimport {StepTimingFunction} from './AnimationTimeline.js';\n\nconst UIStrings = {\n  /**\n  *@description Title of the first and last points of an animation\n  */\n  animationEndpointSlider: 'Animation Endpoint slider',\n  /**\n  *@description Title of an Animation Keyframe point\n  */\n  animationKeyframeSlider: 'Animation Keyframe slider',\n  /**\n  *@description Title of an animation keyframe group\n  *@example {anilogo} PH1\n  */\n  sSlider: '{PH1} slider',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/animation/AnimationUI.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\ntype CachedElement = {\n  group: HTMLElement|null,\n  animationLine: HTMLElement|null,\n  keyframePoints: {[x: number]: HTMLElement},\n  keyframeRender: {[x: number]: HTMLElement},\n};\n\nexport class AnimationUI {\n  private animationInternal: AnimationImpl;\n  private timeline: AnimationTimeline;\n  private readonly parentElement: Element;\n  private keyframes?: KeyframeStyle[];\n  private nameElement: HTMLElement;\n  private readonly svg: Element;\n  private activeIntervalGroup: Element;\n  private cachedElements: CachedElement[];\n  private movementInMs: number;\n  private keyboardMovementRateMs: number;\n  private color: string;\n  private node?: SDK.DOMModel.DOMNode|null;\n  private delayLine?: Element;\n  private endDelayLine?: Element;\n  private tailGroup?: Element;\n  private mouseEventType?: Events;\n  private keyframeMoved?: number|null;\n  private downMouseX?: number;\n\n  constructor(animation: AnimationImpl, timeline: AnimationTimeline, parentElement: Element) {\n    this.animationInternal = animation;\n    this.timeline = timeline;\n    this.parentElement = parentElement;\n\n    const keyframesRule = this.animationInternal.source().keyframesRule();\n    if (keyframesRule) {\n      this.keyframes = keyframesRule.keyframes();\n    }\n    this.nameElement = (parentElement.createChild('div', 'animation-name') as HTMLElement);\n    this.nameElement.textContent = this.animationInternal.name();\n\n    this.svg = UI.UIUtils.createSVGChild(parentElement, 'svg', 'animation-ui');\n    this.svg.setAttribute('height', Options.AnimationSVGHeight.toString());\n    (this.svg as HTMLElement).style.marginLeft = '-' + Options.AnimationMargin + 'px';\n    this.svg.addEventListener('contextmenu', this.onContextMenu.bind(this));\n    this.activeIntervalGroup = UI.UIUtils.createSVGChild(this.svg, 'g');\n    UI.UIUtils.installDragHandle(\n        this.activeIntervalGroup, this.mouseDown.bind(this, Events.AnimationDrag, null), this.mouseMove.bind(this),\n        this.mouseUp.bind(this), '-webkit-grabbing', '-webkit-grab');\n    AnimationUI.installDragHandleKeyboard(\n        this.activeIntervalGroup, this.keydownMove.bind(this, Events.AnimationDrag, null));\n\n    this.cachedElements = [];\n\n    this.movementInMs = 0;\n    this.keyboardMovementRateMs = 50;\n    this.color = AnimationUI.colorForAnimation(this.animationInternal);\n  }\n\n  static colorForAnimation(animation: AnimationImpl): string {\n    const names = Array.from(Colors.keys());\n    const hashCode = Platform.StringUtilities.hashCode(animation.name() || animation.id());\n    const cappedHashCode = hashCode % names.length;\n    const colorName = names[cappedHashCode];\n    const color = Colors.get(colorName);\n    if (!color) {\n      throw new Error('Unable to locate color');\n    }\n    return color.asString(Common.Color.Format.RGB) || '';\n  }\n\n  static installDragHandleKeyboard(element: Element, elementDrag: (arg0: Event) => void): void {\n    element.addEventListener('keydown', elementDrag, false);\n  }\n\n  animation(): AnimationImpl {\n    return this.animationInternal;\n  }\n\n  setNode(node: SDK.DOMModel.DOMNode|null): void {\n    this.node = node;\n  }\n\n  private createLine(parentElement: HTMLElement, className: string): Element {\n    const line = UI.UIUtils.createSVGChild(parentElement, 'line', className);\n    line.setAttribute('x1', Options.AnimationMargin.toString());\n    line.setAttribute('y1', Options.AnimationHeight.toString());\n    line.setAttribute('y2', Options.AnimationHeight.toString());\n    (line as HTMLElement).style.stroke = this.color;\n    return line;\n  }\n\n  private drawAnimationLine(iteration: number, parentElement: HTMLElement): void {\n    const cache = this.cachedElements[iteration];\n    if (!cache.animationLine) {\n      cache.animationLine = (this.createLine(parentElement, 'animation-line') as HTMLElement);\n    }\n    if (!cache.animationLine) {\n      return;\n    }\n\n    cache.animationLine.setAttribute(\n        'x2', (this.duration() * this.timeline.pixelMsRatio() + Options.AnimationMargin).toFixed(2));\n  }\n\n  private drawDelayLine(parentElement: HTMLElement): void {\n    if (!this.delayLine || !this.endDelayLine) {\n      this.delayLine = this.createLine(parentElement, 'animation-delay-line');\n      this.endDelayLine = this.createLine(parentElement, 'animation-delay-line');\n    }\n    const fill = this.animationInternal.source().fill();\n    this.delayLine.classList.toggle('animation-fill', fill === 'backwards' || fill === 'both');\n    const margin = Options.AnimationMargin;\n    this.delayLine.setAttribute('x1', margin.toString());\n    this.delayLine.setAttribute('x2', (this.delay() * this.timeline.pixelMsRatio() + margin).toFixed(2));\n    const forwardsFill = fill === 'forwards' || fill === 'both';\n    this.endDelayLine.classList.toggle('animation-fill', forwardsFill);\n    const leftMargin = Math.min(\n        this.timeline.width(),\n        (this.delay() + this.duration() * this.animationInternal.source().iterations()) * this.timeline.pixelMsRatio());\n    (this.endDelayLine as HTMLElement).style.transform = 'translateX(' + leftMargin.toFixed(2) + 'px)';\n    this.endDelayLine.setAttribute('x1', margin.toString());\n    this.endDelayLine.setAttribute(\n        'x2',\n        forwardsFill ? (this.timeline.width() - leftMargin + margin).toFixed(2) :\n                       (this.animationInternal.source().endDelay() * this.timeline.pixelMsRatio() + margin).toFixed(2));\n  }\n\n  private drawPoint(iteration: number, parentElement: Element, x: number, keyframeIndex: number, attachEvents: boolean):\n      void {\n    if (this.cachedElements[iteration].keyframePoints[keyframeIndex]) {\n      this.cachedElements[iteration].keyframePoints[keyframeIndex].setAttribute('cx', x.toFixed(2));\n      return;\n    }\n\n    const circle =\n        (UI.UIUtils.createSVGChild(\n             parentElement, 'circle', keyframeIndex <= 0 ? 'animation-endpoint' : 'animation-keyframe-point') as\n         HTMLElement);\n    circle.setAttribute('cx', x.toFixed(2));\n    circle.setAttribute('cy', Options.AnimationHeight.toString());\n    circle.style.stroke = this.color;\n    circle.setAttribute('r', (Options.AnimationMargin / 2).toString());\n    circle.tabIndex = 0;\n    UI.ARIAUtils.setAccessibleName(\n        circle,\n        keyframeIndex <= 0 ? i18nString(UIStrings.animationEndpointSlider) :\n                             i18nString(UIStrings.animationKeyframeSlider));\n\n    if (keyframeIndex <= 0) {\n      circle.style.fill = this.color;\n    }\n    this.cachedElements[iteration].keyframePoints[keyframeIndex] = (circle as HTMLElement);\n\n    if (!attachEvents) {\n      return;\n    }\n\n    let eventType: Events;\n    if (keyframeIndex === 0) {\n      eventType = Events.StartEndpointMove;\n    } else if (keyframeIndex === -1) {\n      eventType = Events.FinishEndpointMove;\n    } else {\n      eventType = Events.KeyframeMove;\n    }\n    UI.UIUtils.installDragHandle(\n        circle, this.mouseDown.bind(this, eventType, keyframeIndex), this.mouseMove.bind(this), this.mouseUp.bind(this),\n        'ew-resize');\n    AnimationUI.installDragHandleKeyboard(circle, this.keydownMove.bind(this, eventType, keyframeIndex));\n  }\n\n  private renderKeyframe(\n      iteration: number, keyframeIndex: number, parentElement: HTMLElement, leftDistance: number, width: number,\n      easing: string): void {\n    function createStepLine(parentElement: HTMLElement, x: number, strokeColor: string): void {\n      const line = (UI.UIUtils.createSVGChild(parentElement, 'line') as HTMLElement);\n      line.setAttribute('x1', x.toString());\n      line.setAttribute('x2', x.toString());\n      line.setAttribute('y1', Options.AnimationMargin.toString());\n      line.setAttribute('y2', Options.AnimationHeight.toString());\n      line.style.stroke = strokeColor;\n    }\n\n    const bezier = UI.Geometry.CubicBezier.parse(easing);\n    const cache = this.cachedElements[iteration].keyframeRender;\n    if (!cache[keyframeIndex]) {\n      const svg = bezier ? UI.UIUtils.createSVGChild(parentElement, 'path', 'animation-keyframe') :\n                           UI.UIUtils.createSVGChild(parentElement, 'g', 'animation-keyframe-step');\n      cache[keyframeIndex] = (svg as HTMLElement);\n    }\n    const group = cache[keyframeIndex];\n    group.tabIndex = 0;\n    UI.ARIAUtils.setAccessibleName(group, i18nString(UIStrings.sSlider, {PH1: this.animationInternal.name()}));\n    group.style.transform = 'translateX(' + leftDistance.toFixed(2) + 'px)';\n\n    if (easing === 'linear') {\n      group.style.fill = this.color;\n      const height = InlineEditor.BezierUI.Height;\n      group.setAttribute(\n          'd', ['M', 0, height, 'L', 0, 5, 'L', width.toFixed(2), 5, 'L', width.toFixed(2), height, 'Z'].join(' '));\n    } else if (bezier) {\n      group.style.fill = this.color;\n      InlineEditor.BezierUI.BezierUI.drawVelocityChart(bezier, group, width);\n    } else {\n      const stepFunction = StepTimingFunction.parse(easing);\n      group.removeChildren();\n      const offsetMap: {[x: string]: number} = {'start': 0, 'middle': 0.5, 'end': 1};\n      if (stepFunction) {\n        const offsetWeight = offsetMap[stepFunction.stepAtPosition];\n        for (let i = 0; i < stepFunction.steps; i++) {\n          createStepLine(group, (i + offsetWeight) * width / stepFunction.steps, this.color);\n        }\n      }\n    }\n  }\n\n  redraw(): void {\n    const maxWidth = this.timeline.width() - Options.AnimationMargin;\n\n    this.svg.setAttribute('width', (maxWidth + 2 * Options.AnimationMargin).toFixed(2));\n    (this.activeIntervalGroup as HTMLElement).style.transform =\n        'translateX(' + (this.delay() * this.timeline.pixelMsRatio()).toFixed(2) + 'px)';\n\n    this.nameElement.style.transform =\n        'translateX(' + (this.delay() * this.timeline.pixelMsRatio() + Options.AnimationMargin).toFixed(2) + 'px)';\n    this.nameElement.style.width = (this.duration() * this.timeline.pixelMsRatio()).toFixed(2) + 'px';\n    this.drawDelayLine((this.svg as HTMLElement));\n\n    if (this.animationInternal.type() === 'CSSTransition') {\n      this.renderTransition();\n      return;\n    }\n\n    this.renderIteration(this.activeIntervalGroup, 0);\n    if (!this.tailGroup) {\n      this.tailGroup = UI.UIUtils.createSVGChild(this.activeIntervalGroup, 'g', 'animation-tail-iterations');\n    }\n    const iterationWidth = this.duration() * this.timeline.pixelMsRatio();\n    let iteration;\n    for (iteration = 1; iteration < this.animationInternal.source().iterations() &&\n         iterationWidth * (iteration - 1) < this.timeline.width();\n         iteration++) {\n      this.renderIteration(this.tailGroup, iteration);\n    }\n    while (iteration < this.cachedElements.length) {\n      const poppedElement = this.cachedElements.pop();\n      if (poppedElement && poppedElement.group) {\n        poppedElement.group.remove();\n      }\n    }\n  }\n\n  private renderTransition(): void {\n    const activeIntervalGroup = (this.activeIntervalGroup as HTMLElement);\n    if (!this.cachedElements[0]) {\n      this.cachedElements[0] = {animationLine: null, keyframePoints: {}, keyframeRender: {}, group: null};\n    }\n    this.drawAnimationLine(0, activeIntervalGroup);\n    this.renderKeyframe(\n        0, 0, activeIntervalGroup, Options.AnimationMargin, this.duration() * this.timeline.pixelMsRatio(),\n        this.animationInternal.source().easing());\n    this.drawPoint(0, activeIntervalGroup, Options.AnimationMargin, 0, true);\n    this.drawPoint(\n        0, activeIntervalGroup, this.duration() * this.timeline.pixelMsRatio() + Options.AnimationMargin, -1, true);\n  }\n\n  private renderIteration(parentElement: Element, iteration: number): void {\n    if (!this.cachedElements[iteration]) {\n      this.cachedElements[iteration] = {\n        animationLine: null,\n        keyframePoints: {},\n        keyframeRender: {},\n        group: (UI.UIUtils.createSVGChild(parentElement, 'g') as HTMLElement),\n      };\n    }\n    const group = this.cachedElements[iteration].group;\n    if (!group) {\n      return;\n    }\n\n    group.style.transform =\n        'translateX(' + (iteration * this.duration() * this.timeline.pixelMsRatio()).toFixed(2) + 'px)';\n    this.drawAnimationLine(iteration, group);\n    if (this.keyframes && this.keyframes.length > 1) {\n      for (let i = 0; i < this.keyframes.length - 1; i++) {\n        const leftDistance = this.offset(i) * this.duration() * this.timeline.pixelMsRatio() + Options.AnimationMargin;\n        const width = this.duration() * (this.offset(i + 1) - this.offset(i)) * this.timeline.pixelMsRatio();\n        this.renderKeyframe(iteration, i, group, leftDistance, width, this.keyframes[i].easing());\n        if (i || (!i && iteration === 0)) {\n          this.drawPoint(iteration, group, leftDistance, i, iteration === 0);\n        }\n      }\n    }\n    this.drawPoint(\n        iteration, group, this.duration() * this.timeline.pixelMsRatio() + Options.AnimationMargin, -1,\n        iteration === 0);\n  }\n\n  private delay(): number {\n    let delay = this.animationInternal.source().delay();\n    if (this.mouseEventType === Events.AnimationDrag || this.mouseEventType === Events.StartEndpointMove) {\n      delay += this.movementInMs;\n    }\n    // FIXME: add support for negative start delay\n    return Math.max(0, delay);\n  }\n\n  private duration(): number {\n    let duration = this.animationInternal.source().duration();\n    if (this.mouseEventType === Events.FinishEndpointMove) {\n      duration += this.movementInMs;\n    } else if (this.mouseEventType === Events.StartEndpointMove) {\n      duration -= Math.max(this.movementInMs, -this.animationInternal.source().delay());\n      // Cannot have negative delay\n    }\n    return Math.max(0, duration);\n  }\n\n  private offset(i: number): number {\n    if (!this.keyframes) {\n      throw new Error('Unable to calculate offset; keyframes do not exist');\n    }\n\n    let offset = this.keyframes[i].offsetAsNumber();\n    if (this.mouseEventType === Events.KeyframeMove && i === this.keyframeMoved) {\n      console.assert(i > 0 && i < this.keyframes.length - 1, 'First and last keyframe cannot be moved');\n      offset += this.movementInMs / this.animationInternal.source().duration();\n      offset = Math.max(offset, this.keyframes[i - 1].offsetAsNumber());\n      offset = Math.min(offset, this.keyframes[i + 1].offsetAsNumber());\n    }\n    return offset;\n  }\n\n  private mouseDown(mouseEventType: Events, keyframeIndex: number|null, event: Event): boolean {\n    const mouseEvent = (event as MouseEvent);\n    if (mouseEvent.buttons === 2) {\n      return false;\n    }\n    if (this.svg.enclosingNodeOrSelfWithClass('animation-node-removed')) {\n      return false;\n    }\n    this.mouseEventType = mouseEventType;\n    this.keyframeMoved = keyframeIndex;\n    this.downMouseX = mouseEvent.clientX;\n    event.consume(true);\n    if (this.node) {\n      Common.Revealer.reveal(this.node);\n    }\n    return true;\n  }\n\n  private mouseMove(event: Event): void {\n    const mouseEvent = (event as MouseEvent);\n    this.setMovementAndRedraw((mouseEvent.clientX - (this.downMouseX || 0)) / this.timeline.pixelMsRatio());\n  }\n\n  private setMovementAndRedraw(movement: number): void {\n    this.movementInMs = movement;\n    if (this.delay() + this.duration() > this.timeline.duration() * 0.8) {\n      this.timeline.setDuration(this.timeline.duration() * 1.2);\n    }\n    this.redraw();\n  }\n\n  private mouseUp(event: Event): void {\n    const mouseEvent = (event as MouseEvent);\n    this.movementInMs = (mouseEvent.clientX - (this.downMouseX || 0)) / this.timeline.pixelMsRatio();\n\n    // Commit changes\n    if (this.mouseEventType === Events.KeyframeMove) {\n      if (this.keyframes && this.keyframeMoved !== null && typeof this.keyframeMoved !== 'undefined') {\n        this.keyframes[this.keyframeMoved].setOffset(this.offset(this.keyframeMoved));\n      }\n    } else {\n      this.animationInternal.setTiming(this.duration(), this.delay());\n    }\n\n    this.movementInMs = 0;\n    this.redraw();\n\n    delete this.mouseEventType;\n    delete this.downMouseX;\n    delete this.keyframeMoved;\n  }\n\n  private keydownMove(mouseEventType: Events, keyframeIndex: number|null, event: Event): void {\n    const keyboardEvent = (event as KeyboardEvent);\n    this.mouseEventType = mouseEventType;\n    this.keyframeMoved = keyframeIndex;\n    switch (keyboardEvent.key) {\n      case 'ArrowLeft':\n      case 'ArrowUp':\n        this.movementInMs = -this.keyboardMovementRateMs;\n        break;\n      case 'ArrowRight':\n      case 'ArrowDown':\n        this.movementInMs = this.keyboardMovementRateMs;\n        break;\n      default:\n        return;\n    }\n    if (this.mouseEventType === Events.KeyframeMove) {\n      if (this.keyframes && this.keyframeMoved !== null) {\n        this.keyframes[this.keyframeMoved].setOffset(this.offset(this.keyframeMoved));\n      }\n    } else {\n      this.animationInternal.setTiming(this.duration(), this.delay());\n    }\n    this.setMovementAndRedraw(0);\n\n    delete this.mouseEventType;\n    delete this.keyframeMoved;\n\n    event.consume(true);\n  }\n\n  private onContextMenu(event: Event): void {\n    function showContextMenu(remoteObject: SDK.RemoteObject.RemoteObject|null): void {\n      if (!remoteObject) {\n        return;\n      }\n      const contextMenu = new UI.ContextMenu.ContextMenu(event);\n      contextMenu.appendApplicableItems(remoteObject);\n      contextMenu.show();\n    }\n\n    this.animationInternal.remoteObjectPromise().then(showContextMenu);\n    event.consume(true);\n  }\n}\n\nexport const enum Events {\n  AnimationDrag = 'AnimationDrag',\n  KeyframeMove = 'KeyframeMove',\n  StartEndpointMove = 'StartEndpointMove',\n  FinishEndpointMove = 'FinishEndpointMove',\n}\n\nexport const Options = {\n  AnimationHeight: 26,\n  AnimationSVGHeight: 50,\n  AnimationMargin: 7,\n  EndpointsClickRegionSize: 10,\n  GridCanvasHeight: 40,\n};\n\nexport const Colors = new Map<string, Common.Color.Color|null>([\n  ['Purple', Common.Color.Color.parse('#9C27B0')],\n  ['Light Blue', Common.Color.Color.parse('#03A9F4')],\n  ['Deep Orange', Common.Color.Color.parse('#FF5722')],\n  ['Blue', Common.Color.Color.parse('#5677FC')],\n  ['Lime', Common.Color.Color.parse('#CDDC39')],\n  ['Blue Grey', Common.Color.Color.parse('#607D8B')],\n  ['Pink', Common.Color.Color.parse('#E91E63')],\n  ['Green', Common.Color.Color.parse('#0F9D58')],\n  ['Brown', Common.Color.Color.parse('#795548')],\n  ['Cyan', Common.Color.Color.parse('#00BCD4')],\n]);\n"]}