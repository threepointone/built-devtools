{"version":3,"file":"AnimationScreenshotPopover.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationScreenshotPopover.ts"],"names":[],"mappings":"AAAA,gEAAgE;AAChE,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,EAAE,MAAM,2BAA2B,CAAC;AAEhD,OAAO,gCAAgC,MAAM,qCAAqC,CAAC;AAEnF,MAAM,OAAO,0BAA2B,SAAQ,EAAE,CAAC,MAAM,CAAC,IAAI;IACpD,MAAM,CAAqB;IAC3B,KAAK,CAAS;IACd,YAAY,CAAS;IACrB,WAAW,CAAc;IACzB,SAAS,CAAW;IACpB,QAAQ,CAAU;IAC1B,YAAY,MAA0B;QACpC,KAAK,CAAC,IAAI,CAAC,CAAC;QACZ,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QAElC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;QAClE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;YAC1B,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YACvC,KAAK,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;SAC9B;QACD,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;QACf,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;QACvC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAK,EAAE,oBAAoB,CAAC,CAAC;IAClF,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC7F,IAAI,CAAC,gBAAgB,CAAC,CAAC,gCAAgC,CAAC,CAAC,CAAC;IAC5D,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC9D,OAAO,IAAI,CAAC,QAAQ,CAAC;IACvB,CAAC;IAEO,WAAW;QACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,qBAAqB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAE7F,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,OAAO;SACR;QACD,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC;QACjC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACnB,OAAO;SACR;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QACrC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;QAClE,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,SAAS,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;QACrE,IAAI,IAAI,CAAC,YAAY,GAAG,SAAS,KAAK,SAAS,GAAG,CAAC,EAAE;YACnD,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;SACpB;QACD,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,SAAS,GAAG,CAAC,CAAC,GAAG,SAAS,GAAG,GAAG,GAAG,GAAG,CAAC;IAC7F,CAAC;CACF","sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport animationScreenshotPopoverStyles from './animationScreenshotPopover.css.js';\n\nexport class AnimationScreenshotPopover extends UI.Widget.VBox {\n  private frames: HTMLImageElement[];\n  private rafId: number;\n  private currentFrame: number;\n  private progressBar: HTMLElement;\n  private showFrame?: boolean;\n  private endDelay?: number;\n  constructor(images: HTMLImageElement[]) {\n    super(true);\n    console.assert(images.length > 0);\n\n    this.contentElement.classList.add('animation-screenshot-popover');\n    this.frames = images;\n    for (const image of images) {\n      this.contentElement.appendChild(image);\n      image.style.display = 'none';\n    }\n    this.rafId = 0;\n    this.currentFrame = 0;\n    this.frames[0].style.display = 'block';\n    this.progressBar = this.contentElement.createChild('div', 'animation-progress');\n  }\n\n  wasShown(): void {\n    this.rafId = this.contentElement.window().requestAnimationFrame(this.changeFrame.bind(this));\n    this.registerCSSFiles([animationScreenshotPopoverStyles]);\n  }\n\n  willHide(): void {\n    this.contentElement.window().cancelAnimationFrame(this.rafId);\n    delete this.endDelay;\n  }\n\n  private changeFrame(): void {\n    this.rafId = this.contentElement.window().requestAnimationFrame(this.changeFrame.bind(this));\n\n    if (this.endDelay) {\n      this.endDelay--;\n      return;\n    }\n    this.showFrame = !this.showFrame;\n    if (!this.showFrame) {\n      return;\n    }\n\n    const numFrames = this.frames.length;\n    this.frames[this.currentFrame % numFrames].style.display = 'none';\n    this.currentFrame++;\n    this.frames[(this.currentFrame) % numFrames].style.display = 'block';\n    if (this.currentFrame % numFrames === numFrames - 1) {\n      this.endDelay = 50;\n    }\n    this.progressBar.style.width = (this.currentFrame % numFrames + 1) / numFrames * 100 + '%';\n  }\n}\n"]}